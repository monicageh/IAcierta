<!-- src/app/game/game.component.html -->

<div class="game-wrapper">

  <!-- 1) Logo en esquina superior izquierda -->
  <img src="assets/logoIAcierta.png"
       alt="IAcierta"
       class="logo" />

  <!-- 2) Rosco con posiciones absolutas -->
  <div #roscoRef class="rosco">

    <!-- 2a) Bot√≥n Salir -->
    <button class="exit-button" (click)="exitGame()">‚úñ</button>

    <!-- 2b) Marcadores dentro del rosco -->
    <div class="scoreboard">
      <div class="score-item player">
        <span class="label">Jugador</span>
        <span class="value">{{ playerScore }}</span>
      </div>
      <div class="score-item chatgpt">
        <span class="label">ChatGPT</span>
        <span class="value">{{ chatgptScore }}</span>
      </div>
    </div>

    <!-- 2c) C√≠rculos num√©ricos -->
    <div *ngFor="let l of letters"
         class="letter"
         [ngClass]="{
           'active': l.index === currentIndex,
           'correct': answerStatus[l.index] === 'correct',
           'incorrect': answerStatus[l.index] === 'incorrect'
         }"
         [style.width.px]="l.size"
         [style.height.px]="l.size"
         [style.left.px]="l.x"
         [style.top.px]="l.y"
         [style.fontSize.px]="l.size * 0.6">
      {{ l.value }}
    </div>

    <!-- 3) Panel central -->
  <div class="inner-panel">
    <ng-container *ngIf="question; else loading">

      <!-- Indicador ‚ÄúEmpieza por la X:‚Äù -->
      <div class="start-line">
        <span class="start-phrase">Empieza por la</span>
        <span class="start-letter">{{ question.respuestaCorrecta.charAt(0) }}</span>
        <span class="start-phrase">:</span>
      </div>

      <!-- Nuevo recuadro para el cuerpo de la pregunta -->
      <div class="question-body-box">
        {{ questionBody }}
      </div>

      <!-- Input y bot√≥n -->
      <input class="answer-input"
            type="text"
            [(ngModel)]="userAnswer"
            placeholder="Tu respuesta‚Ä¶" />

      <button class="check-button"
              *ngIf="!showFeedback"
              (click)="checkAnswer()">
        Comprobar
      </button>

      <!-- Feedback: resultado del jugador y de ChatGPT -->
      <div *ngIf="showFeedback"
          class="feedback"
          [class.correct]="isCorrect"
          [class.incorrect]="!isCorrect">

        <!-- 1) Resultado del jugador -->
        <div class="player-feedback">
          <span *ngIf="isCorrect; else playerWrong">
            ‚úîÔ∏è ¬°Correcto!
          </span>
          <ng-template #playerWrong>
            ‚ùå La respuesta es:
            <strong>{{ feedback?.correctAnswer }}</strong>
          </ng-template>
        </div>

        <!-- 2) Resultado de ChatGPT -->
        <div class="chatgpt-feedback">
          <span *ngIf="feedback?.chatgptCorrect; else chatgptWrong">
            ü§ñ ChatGPT acert√≥ con:
            <strong>{{ feedback?.chatgptAnswer }}</strong>
          </span>
          <ng-template #chatgptWrong>
            ü§ñ ChatGPT fall√≥ con:
            <strong>{{ feedback?.chatgptAnswer }}</strong>
          </ng-template>
        </div>

        <!-- 3) Bot√≥n Siguiente -->
        <button class="next-button" (click)="nextQuestion()">
          Siguiente pregunta
        </button>
      </div>


    </ng-container>

    <ng-template #loading>
      <p>Cargando preguntas‚Ä¶</p>
    </ng-template>
  </div>

  </div>
</div>
